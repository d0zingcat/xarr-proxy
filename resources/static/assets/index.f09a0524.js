import{u as j,h as x,_ as Ie}from"./index.08985164.js";/* empty css               *//* empty css               *//* empty css               *//* empty css              *//* empty css              *//* empty css               *//* empty css              *//* empty css               *//* empty css               *//* empty css               *//* empty css               */import{d as X,a as u,w as we,A as L,aD as F,aE as t,aF as e,u as g,bx as Y,aY as H,bC as Ve,aX as J,b1 as W,bG as Ce,r as R,c as $e,aI as _,B as ke,aK as k,aL as S,D as M,aQ as T,bw as Se,by as Te,bz as ze,a$ as Le,b0 as xe,bA as Ue,bB as Be}from"./arco.f2670ebc.js";/* empty css               */import{c as Ne}from"./cloneDeep.c28e1f48.js";import{L as qe}from"./constants.9d49e7ca.js";import"./vue.758b0c86.js";const Ae=X({__name:"index",props:{tvdbIdList:{type:Array,default:()=>[]},data:{type:Object,default:()=>({})},tmdb:{type:String,default:()=>""}},emits:["save"],setup(v,{emit:y}){const p=v,a=u(),{t:f}=j(),n=u(),V=async o=>{var b;await((b=a.value)==null?void 0:b.validate())||await new Promise(c=>{y("save",n.value,h=>{c(h)})})&&o(!0),o(!1)};return we(()=>p.data,o=>{n.value=Ne(o)},{immediate:!0,deep:!0}),(o,r)=>{const b=Y,c=H,h=Ve,U=J,B=W,I=Ce;return L(),F(I,{tmdb:p.tmdb,onBeforeOk:V},{default:t(()=>[e(B,{ref_key:"tmdbRef",ref:a,class:"tmdb-form",model:n.value,"label-col-props":{span:3},"wrapper-col-props":{span:20}},{default:t(()=>[e(c,{field:"tvdbId",label:g(f)("tmdb.form.tvdbId"),rules:[{required:!0,message:o.$t("tmdb.form.tvdbId.error")}],"validate-trigger":["change","input"]},{default:t(()=>[e(b,{modelValue:n.value.tvdbId,"onUpdate:modelValue":r[0]||(r[0]=s=>n.value.tvdbId=s),data:p.tvdbIdList,"allow-clear":"",placeholder:o.$t("tmdb.form.tvdbId.placeholder")},null,8,["modelValue","data","placeholder"])]),_:1},8,["label","rules"]),e(c,{field:"tmdbId",label:g(f)("tmdb.form.tmdbId")},{default:t(()=>[e(b,{modelValue:n.value.tmdbId,"onUpdate:modelValue":r[1]||(r[1]=s=>n.value.tmdbId=s),"allow-clear":"",placeholder:o.$t("tmdb.form.tmdbId.placeholder")},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),e(c,{field:"language",label:o.$t("tmdb.form.language"),rules:[{required:!0,message:o.$t("tmdb.form.language.error")}],"validate-trigger":["change","input"]},{default:t(()=>[e(h,{modelValue:n.value.language,"onUpdate:modelValue":r[2]||(r[2]=s=>n.value.language=s),placeholder:o.$t("tmdb.form.language.placeholder"),options:g(qe),"allow-search":""},null,8,["modelValue","placeholder","options"])]),_:1},8,["label","rules"]),e(c,{field:"title",label:g(f)("tmdb.form.title"),rules:[{required:!0,message:o.$t("tmdb.form.title.error")}],"validate-trigger":["change","input"]},{default:t(()=>[e(U,{modelValue:n.value.title,"onUpdate:modelValue":r[3]||(r[3]=s=>n.value.title=s),"allow-clear":"",placeholder:o.$t("tmdb.form.title.placeholder")},null,8,["modelValue","placeholder"])]),_:1},8,["label","rules"])]),_:1},8,["model"])]),_:1},8,["tmdb"])}}});function De(){return x.post("/tmdb/title/sync")}function Fe(v){return x.get("/tmdb/title/query",{params:v})}function Ke(v){return x.post("/tmdb/title/remove",v)}function Q(v){return x.post("/tmdb/title/save",v)}const Pe={class:"container"},Oe=X({__name:"index",setup(v){const y=l=>{l.value=!0},p=l=>{setTimeout(()=>{l.value=!1},300)},{t:a}=j(),f=u(!1),n=u(!1),V=u(!1),o=u(!1),r=u(!1),b=u(!1),c=u([]),h=u([]),U=R({type:"checkbox",showCheckedAll:!0,onlyCurrent:!1}),B=$e(()=>[{title:a("tmdb.title.tvdbId"),dataIndex:"tvdbId",align:"center",width:100,ellipsis:!0,tooltip:!0},{title:a("tmdb.title.tmdbId"),dataIndex:"tmdbId",align:"center",width:100,ellipsis:!0,tooltip:!0},{title:a("tmdb.title.language"),dataIndex:"language",align:"center",width:100,ellipsis:!0,tooltip:!0},{title:a("tmdb.title.title"),dataIndex:"title",slotName:"title",ellipsis:!0,tooltip:!0},{title:a("tmdb.title.cleanTitle"),dataIndex:"cleanTitle",ellipsis:!0,tooltip:!0},{title:a("tmdb.title.validStatus"),dataIndex:"validStatus",slotName:"validStatus",align:"center",width:100},{title:a("tmdb.title.edit"),slotName:"edit",align:"center",width:100}]),I={current:1,pageSize:10},s=R({showTotal:!0,showPageSize:!0,pageSizeOptions:[10,20,100,1e3],...I}),K=()=>({tvdbId:void 0,title:void 0}),m=u(K()),z=async l=>{y(V),await Fe(l).then(i=>{h.value=i.data.list,s.current=l.current,s.total=i.data.total}).finally(()=>{p(V)})},C=()=>{y(n),z({...I,...m.value}).finally(()=>{p(n)})},Z=()=>{m.value=K()},ee=l=>{z({...I,current:l,...m.value})},te=l=>{I.pageSize=l,s.pageSize=l,z({...s,...m.value})},N=u(""),q=u({}),le=()=>{N.value=a("tmdb.form.add.title"),q.value={language:"zh-CN"},f.value=!0},ae=()=>{if(!c.value||c.value.length===0){T.warning(a("tmdb.title.select.warning"));return}y(r),Ke(c.value).then(()=>{T.success(a("tmdb.title.remove.success")),z({...s,...m.value})}).finally(()=>{p(r)})},oe=()=>{y(b),De().then(()=>{T.success(a("tmdb.title.sync.success")),C()}).finally(()=>{p(b)})},ne=l=>{Q(l).then(()=>{T.success(a("tmdb.title.save.success")),C()})},de=l=>{N.value=a("tmdb.form.edit.title"),q.value=l,f.value=!0},se=(l,i)=>{Q(l).then(()=>{T.success(a("tmdb.title.save.success")),C(),i(!0)}).catch(()=>{i(!1)}).finally(()=>{p(o)})};return C(),(l,i)=>{const ie=_("Breadcrumb"),P=J,O=H,$=Se,re=Y,A=Te,ue=W,E=ze,ce=_("icon-search"),w=Le,me=_("icon-refresh"),G=xe,pe=_("icon-plus"),be=_("icon-delete"),_e=_("icon-sync"),ve=_("icon-check-circle"),fe=_("icon-close-circle"),ge=_("icon-edit"),ye=Ue,he=Be;return L(),ke("div",Pe,[e(ie,{items:["menu.sonarr","menu.sonarr.tmdb"]},null,8,["items"]),e(Ae,{visible:f.value,"onUpdate:visible":i[0]||(i[0]=d=>f.value=d),data:q.value,title:N.value,onSave:se},null,8,["visible","data","title"]),e(he,{class:"general-card",title:g(a)("menu.sonarr.tmdb")},{default:t(()=>[e(A,null,{default:t(()=>[e($,{flex:1},{default:t(()=>[e(ue,{"label-col-props":{span:5},"wrapper-col-props":{span:15},"label-align":"left",model:m.value},{default:t(()=>[e(A,{gutter:16},{default:t(()=>[e($,{span:8},{default:t(()=>[e(O,{field:"title",label:l.$t("tmdb.title.title")},{default:t(()=>[e(P,{modelValue:m.value.title,"onUpdate:modelValue":i[1]||(i[1]=d=>m.value.title=d),"allow-clear":"",placeholder:l.$t("tmdb.title.title.placeholder")},null,8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1}),e($,{span:8},{default:t(()=>[e(O,{field:"tvdbId","label-col-props":{span:8},label:l.$t("tmdb.title.tvdbId")},{default:t(()=>[e(re,{modelValue:m.value.tvdbId,"onUpdate:modelValue":i[2]||(i[2]=d=>m.value.tvdbId=d),min:0,"allow-clear":"",placeholder:l.$t("tmdb.title.tvdbId.placeholder")},null,8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),e(E,{style:{height:"35px"},direction:"vertical"}),e($,{flex:"86px",style:{"text-align":"right"}},{default:t(()=>[e(G,{size:18},{default:t(()=>[e(w,{type:"primary",loading:n.value,onClick:C},{icon:t(()=>[e(ce)]),default:t(()=>[k(" "+S(l.$t("tmdb.title.search")),1)]),_:1},8,["loading"]),e(w,{onClick:Z},{icon:t(()=>[e(me)]),default:t(()=>[k(" "+S(l.$t("tmdb.title.reset")),1)]),_:1})]),_:1})]),_:1})]),_:1}),e(E,{style:{"margin-top":"0"}}),e(A,{style:{"margin-bottom":"16px"}},{default:t(()=>[e($,{span:12},{default:t(()=>[e(G,null,{default:t(()=>[e(w,{type:"primary",status:"success",loading:o.value,onClick:le},{icon:t(()=>[e(pe)]),default:t(()=>[k(" "+S(l.$t("tmdb.title.add")),1)]),_:1},8,["loading"]),e(w,{type:"primary",status:"danger",loading:r.value,onClick:ae},{icon:t(()=>[e(be)]),default:t(()=>[k(" "+S(l.$t("tmdb.title.remove")),1)]),_:1},8,["loading"]),e(w,{type:"primary",loading:b.value,onClick:oe},{icon:t(()=>[e(_e)]),default:t(()=>[k(" "+S(l.$t("tmdb.title.sync")),1)]),_:1},8,["loading"])]),_:1})]),_:1})]),_:1}),e(ye,{selectedKeys:c.value,"onUpdate:selectedKeys":i[3]||(i[3]=d=>c.value=d),"row-key":"id",size:"medium",data:h.value,columns:g(B),bordered:!1,loading:V.value,pagination:s,"row-selection":g(U),onPageSizeChange:te,onPageChange:ee},{title:t(({record:d})=>[e(P,{modelValue:d.title,"onUpdate:modelValue":D=>d.title=D,onChange:D=>ne(d)},null,8,["modelValue","onUpdate:modelValue","onChange"])]),validStatus:t(({record:d})=>[d.validStatus===1?(L(),F(ve,{key:0,size:"21",style:M({color:"rgb(var(--green-6))"})},null,8,["style"])):(L(),F(fe,{key:1,size:"21",style:M({color:"rgb(var(--orange-6))"})},null,8,["style"]))]),edit:t(({record:d})=>[e(w,{type:"text",size:"mini",onClick:D=>de(d)},{default:t(()=>[e(ge,{size:"medium"})]),_:2},1032,["onClick"])]),_:1},8,["selectedKeys","data","columns","loading","pagination","row-selection"])]),_:1},8,["title"])])}}});const nt=Ie(Oe,[["__scopeId","data-v-b27991c0"]]);export{nt as default};
