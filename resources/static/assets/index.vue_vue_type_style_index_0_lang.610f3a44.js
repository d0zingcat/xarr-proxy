import{h as w,u as y}from"./index.08985164.js";/* empty css               *//* empty css               *//* empty css               *//* empty css              *//* empty css               *//* empty css               *//* empty css              *//* empty css               *//* empty css               */import{d as C,a as c,w as U,A as R,aD as q,aE as u,aF as r,u as m,bE as O,aY as A,bx as B,aX as F,bF as I,b1 as z,bG as D}from"./arco.f2670ebc.js";import{c as E}from"./cloneDeep.c28e1f48.js";function L(f){return w.get("/rule/test",{params:f})}const Q=C({__name:"index",props:{tokenList:{type:Array,default:()=>[]},data:{type:Object,default:()=>({})},title:{type:String,default:()=>""}},emits:["save"],setup(f,{emit:V}){const v=f,h=c(),{t:n}=y(),e=c(),k=async l=>{var s;await((s=h.value)==null?void 0:s.validate())||await new Promise(t=>{V("save",e.value,p=>{t(p)})})&&l(!0),l(!1)},g=c(!0),x=l=>{l==="season"||l==="episode"?g.value=!1:(e.value.offset=0,g.value=!0)},d=()=>{e.value.replacement&&(!e.value.remark&&e.value.token&&e.value.token!=="season"&&e.value.token!=="episode"&&e.value.replacement.indexOf("$")===-1&&(e.value.remark=e.value.replacement.replaceAll(/(\[|\])/g,"").trim()),e.value.regex&&e.value.example&&L({regex:e.value.regex,replacement:e.value.replacement,example:e.value.example,offset:e.value.offset}).then(l=>{e.value.result=l.data}))};return U(()=>v.data,l=>{e.value=E(l),d()},{immediate:!0,deep:!0}),(l,a)=>{const s=O,t=A,p=B,i=F,b=I,_=z,$=D;return R(),q($,{title:v.title,onBeforeOk:k},{default:u(()=>[r(_,{ref_key:"ruleRef",ref:h,class:"rule-form",model:e.value,"label-col-props":{span:3},"wrapper-col-props":{span:20}},{default:u(()=>[r(t,{field:"token",label:m(n)("rule.form.token"),rules:[{required:!0,message:l.$t("rule.form.token.error")}],"validate-trigger":["change","input"]},{default:u(()=>[r(s,{modelValue:e.value.token,"onUpdate:modelValue":a[0]||(a[0]=o=>e.value.token=o),data:v.tokenList,"allow-clear":"",placeholder:l.$t("rule.form.token.placeholder"),onChange:x},null,8,["modelValue","data","placeholder"])]),_:1},8,["label","rules"]),r(t,{field:"priority",label:m(n)("rule.form.priority"),rules:[{required:!0,message:l.$t("rule.form.priority.error")}],"validate-trigger":["change","input"]},{default:u(()=>[r(p,{modelValue:e.value.priority,"onUpdate:modelValue":a[1]||(a[1]=o=>e.value.priority=o),min:0,max:999999,placeholder:l.$t("rule.form.priority.placeholder")},null,8,["modelValue","placeholder"])]),_:1},8,["label","rules"]),r(t,{field:"regex",label:m(n)("rule.form.regex"),rules:[{required:!0,message:l.$t("rule.form.regex.error")}],"validate-trigger":["change","input"]},{default:u(()=>[r(i,{modelValue:e.value.regex,"onUpdate:modelValue":a[2]||(a[2]=o=>e.value.regex=o),"allow-clear":"",placeholder:l.$t("rule.form.regex.placeholder"),onChange:d},null,8,["modelValue","placeholder"])]),_:1},8,["label","rules"]),r(t,{field:"replacement",label:m(n)("rule.form.replacement")},{default:u(()=>[r(i,{modelValue:e.value.replacement,"onUpdate:modelValue":a[3]||(a[3]=o=>e.value.replacement=o),"allow-clear":"",placeholder:l.$t("rule.form.replacement.placeholder"),onChange:d},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),r(t,{field:"offset",label:m(n)("rule.form.offset"),rules:[{required:!0,message:l.$t("rule.form.offset.error")}],"validate-trigger":["change","input"]},{default:u(()=>[r(p,{modelValue:e.value.offset,"onUpdate:modelValue":a[4]||(a[4]=o=>e.value.offset=o),disabled:g.value,min:-999999,max:999999,placeholder:l.$t("rule.form.offset.placeholder"),onChange:d},null,8,["modelValue","disabled","placeholder"])]),_:1},8,["label","rules"]),r(t,{field:"example",label:m(n)("rule.form.example"),rules:[{required:!0,message:l.$t("rule.form.example.error")}],"validate-trigger":["change","input"]},{default:u(()=>[r(b,{modelValue:e.value.example,"onUpdate:modelValue":a[5]||(a[5]=o=>e.value.example=o),"auto-size":{minRows:2,maxRows:5},"allow-clear":"",placeholder:l.$t("rule.form.example.placeholder"),onChange:d},null,8,["modelValue","placeholder"])]),_:1},8,["label","rules"]),r(t,{field:"result",label:m(n)("rule.form.result")},{default:u(()=>[r(b,{modelValue:e.value.result,"onUpdate:modelValue":a[6]||(a[6]=o=>e.value.result=o),"auto-size":{minRows:1,maxRows:5},readonly:""},null,8,["modelValue"])]),_:1},8,["label"]),r(t,{field:"remark",label:m(n)("rule.form.remark"),rules:[{required:!0,message:l.$t("rule.form.remark.error")}],"validate-trigger":["change","input"]},{default:u(()=>[r(i,{modelValue:e.value.remark,"onUpdate:modelValue":a[7]||(a[7]=o=>e.value.remark=o),"allow-clear":"",placeholder:l.$t("rule.form.remark.placeholder")},null,8,["modelValue","placeholder"])]),_:1},8,["label","rules"]),r(t,{field:"author",label:m(n)("rule.form.author"),rules:[{required:!0,message:l.$t("rule.form.author.error")}],"validate-trigger":["change","input"]},{default:u(()=>[r(i,{modelValue:e.value.author,"onUpdate:modelValue":a[8]||(a[8]=o=>e.value.author=o),"allow-clear":"",placeholder:l.$t("rule.form.author.placeholder")},null,8,["modelValue","placeholder"])]),_:1},8,["label","rules"])]),_:1},8,["model"])]),_:1},8,["title"])}}});export{Q as _};
